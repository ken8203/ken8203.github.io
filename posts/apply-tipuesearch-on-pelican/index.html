<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Apply Tipue search on Pelican &#183; Hi im jaychung</title><link rel=stylesheet href=https://blog.jaychung.tw/css/slim.css><link rel=stylesheet href=https://blog.jaychung.tw/css/highlight.min.css><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Source+Code+Pro" rel=stylesheet type=text/css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.ico></head><body><div class=container><div class=header><h1 class=site-title><a href=https://blog.jaychung.tw/>Hi im jaychung</a></h1><p class=site-tagline></p><div class=nav><a class=nav-btn href=#><span class="ci ci-burger"></span></a><ul class=nav-list><li class=spacer>&ac;</li><li><a href=https://github.com/ken8203>Github</a></li><li><a href=https://twitter.com/jaychungtw>Twitter</a></li></ul></div></div><div class=content><div class=post><h2 class=post-title><a href=https://blog.jaychung.tw/posts/apply-tipuesearch-on-pelican/>Apply Tipue search on Pelican</a></h2><div class=post-content><p>每個部落格都需要「搜尋」這個功能，文章少時還好，多了以後想找就不方便。Pelican 並沒有內建文章搜尋的功能，但倒是有個滿酷的套件， Tipue Search 。</p><h2 id=tipue-search>Tipue Search</h2><blockquote><p>Serializes generated HTML to JSON that can be used by jQuery plugin.</p></blockquote><p>簡潔有力的說明，就是將文章轉換成 JSON 檔案，搭配上 jQuery 進行文章搜尋。</p><h2 id=設定--configuration>設定 / Configuration</h2><p>Tipue Search 在 python 的部分是仰賴 <code>BeautifulSoup</code> 這個套件，所以在使用前得先確定自己有沒有安裝。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>pip install beautifulsoup4
</code></pre></div><ol><li><p>下載 <a href=https://github.com/Tipue/Tipue-Search>Tipue Search</a>，然後將裡面的 static 檔案放置到自己主題的目錄下。（<code>themes/&lt;your_theme>/static/tipuesearch/</code>）</p></li><li><p>下載 <a href=https://github.com/getpelican/pelican-plugins/tree/master/tipue_search>Tipue Search Plugin</a>，放到 plugin 資料夾底下，如果還沒有 plugin 這個資料夾可以自己創一個。</p></li></ol><h3 id=編輯-pelicanconfpy>編輯 pelicanconf.py</h3><p>然後要編輯自己的 pelicanconf.py，像我的資料夾名稱是 pelican-plugins，並且要加上 <code>DIRECT_TEMPLATES</code> ，確認要 parse 成 JSON 的頁面有哪些。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>PLUGIN_PATH <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;pelican-plugins&#39;</span>
PLUGINS <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;tipue_search&#39;</span>]
DIRECT_TEMPLATES <span style=color:#f92672>=</span> ((<span style=color:#e6db74>&#39;index&#39;</span>, <span style=color:#e6db74>&#39;tags&#39;</span>, <span style=color:#e6db74>&#39;categories&#39;</span>, <span style=color:#e6db74>&#39;authors&#39;</span>, <span style=color:#e6db74>&#39;archives&#39;</span>, <span style=color:#e6db74>&#39;search&#39;</span>))
</code></pre></div><h3 id=編輯-templates>編輯 templates</h3><p>第一個部分就是先加上 css ：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>link</span> <span style=color:#a6e22e>rel</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ SITEURL }}/theme/tipuesearch/tipuesearch.css&#34;</span>&gt;
</code></pre></div><p>再來是加上搜尋條，外觀可以根據自己喜歡的樣子修改，重點是 <code>name=q</code>：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;searchform&#34;</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/search.html&#34;</span> <span style=color:#a6e22e>onsubmit</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;return (this.elements[&#39;q&#39;].value.length &gt; 0)&#34;</span>&gt;
	&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;searchbox&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;q&#34;</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;12&#34;</span> <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Search&#34;</span>&gt;
&lt;/<span style=color:#f92672>form</span>&gt;
</code></pre></div><p>最後的就是要在 templates 裡面添加 <code>search.html</code>，樣式也可以自己斟酌，但要注意的是 <code>input</code> 的 <code>id</code> 要是 <code>tipue_search_input</code>，否則可能會無法運作：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>{% extends &#39;base.html&#39; %}
{% block title %}
Search - {{ SITENAME|striptags }}
{% endblock title %}

{% block content %}
&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;search-bar&#34;</span>&gt;
	&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;searchform&#34;</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/search.html&#34;</span> <span style=color:#a6e22e>onsubmit</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;return(this.elements[&#39;q&#39;].value.length&gt;0)&#34;</span>&gt;
		&lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;tipue_search_input&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;q&#34;</span> <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Search...&#34;</span>&gt;
	&lt;/<span style=color:#f92672>form</span>&gt;
&lt;/<span style=color:#f92672>div</span>&gt;
&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;tipue_search_content&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;

&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/javascript&#34;</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/javascript&#34;</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ SITEURL }}/theme/tipuesearch/tipuesearch_set.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/javascript&#34;</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;{{ SITEURL }}/theme/tipuesearch/tipuesearch.min.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
&lt;<span style=color:#f92672>script</span>&gt;
	<span style=color:#a6e22e>$</span>(document).<span style=color:#a6e22e>ready</span>(<span style=color:#66d9ef>function</span>() {
	    <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;#tipue_search_input&#39;</span>).<span style=color:#a6e22e>tipuesearch</span>({
	        <span style=color:#e6db74>&#39;show&#39;</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,
	        <span style=color:#e6db74>&#39;mode&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;json&#39;</span>,
	        <span style=color:#e6db74>&#39;contentLocation&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;{{ SITEURL }}/tipuesearch_content.json&#39;</span>
	    });
	});
&lt;/<span style=color:#f92672>script</span>&gt;
{% endblock content %}
</code></pre></div><p>以上就是安裝 Tipue Search 的步驟，每次 <code>make html</code> 以後就會產生 tipuesearch_content.json，供搜尋使用。</p></div></div></div><div class=footer><p>Copyright © 2020. Powered by Hugo.</p></div></div><script src=https://blog.jaychung.tw/js/slim.js></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-56558534-1','auto');ga('send','pageview');</script></body></html>